<!-- This is the final, ultra-realistic, and fully functional version of the game -->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eisernes Kreuz - Final Version</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Georgia', serif; 
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0f1428 100%); 
            color: #e0e0e0; 
            line-height: 1.6; 
            overflow-x: hidden;
            min-height: 100vh;
        }
        .container { display: flex; min-height: 100vh; }
        .sidebar {
                transition: margin-left 0.3s ease; 
            width: 280px; 
            background: linear-gradient(180deg, #0d0d1a 0%, #1a1a2e 50%, #0d0d1a 100%); 
            border-right: 4px solid #d4af37; 
            padding: 20px; 
            overflow-y: auto; 
            position: fixed; 
            left: 0; 
            top: 0; 
            height: 100vh; 
            z-index: 1000;
            box-shadow: 2px 0 20px rgba(212, 175, 55, 0.2);
        }
        .sidebar h1 { 
            color: #d4af37; 
            font-size: 18px; 
            margin-bottom: 30px; 
            text-align: center; 
            border-bottom: 3px solid #d4af37; 
            padding-bottom: 15px;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
            letter-spacing: 2px;
        }
        .nav-section { margin-bottom: 25px; }
        .nav-section h3 { 
            color: #d4af37; 
            font-size: 11px; 
            text-transform: uppercase; 
            margin-bottom: 10px; 
            letter-spacing: 2px;
            opacity: 0.8;
        }
        .nav-button { 
            width: 100%; 
            padding: 12px; 
            margin-bottom: 8px; 
            background: linear-gradient(90deg, rgba(212, 175, 55, 0.05) 0%, rgba(212, 175, 55, 0.1) 100%);
            border: 2px solid rgba(212, 175, 55, 0.3); 
            color: #e0e0e0; 
            cursor: pointer; 
            border-radius: 6px; 
            transition: all 0.3s ease; 
            font-size: 13px; 
            text-align: left;
            font-weight: 500;
        }
        .nav-button:hover { 
            background: linear-gradient(90deg, rgba(212, 175, 55, 0.15) 0%, rgba(212, 175, 55, 0.25) 100%);
            border-color: #d4af37;
            transform: translateX(5px); 
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
        }
        .nav-button.active { 
            background: linear-gradient(90deg, #d4af37 0%, #e0c158 100%); 
            color: #0d0d1a; 
            font-weight: bold;
            border-color: #d4af37;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.5);
        }
        .main-content { 
            margin-left: 280px; 
            flex: 1; 
            padding: 30px; 
            overflow-y: auto;
            background: linear-gradient(180deg, rgba(10, 14, 39, 0.5) 0%, rgba(26, 31, 58, 0.3) 100%);
        }
        .header { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(212, 175, 55, 0.05) 100%); 
            border: 3px solid #d4af37; 
            padding: 25px; 
            margin-bottom: 30px; 
            border-radius: 10px;
            box-shadow: 0 8px 32px rgba(212, 175, 55, 0.15);
        }
        .header h1 { 
            color: #d4af37; 
            font-size: 32px; 
            margin-bottom: 15px;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }
        .header p { color: #b0b0b0; font-size: 14px; }
        .player-info { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); 
            gap: 15px; 
            margin-top: 20px; 
        }
        .info-box { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%);
            border-left: 4px solid #d4af37; 
            padding: 15px; 
            border-radius: 6px;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.1);
        }
        .info-box label { 
            color: #d4af37; 
            font-weight: bold; 
            font-size: 11px; 
            text-transform: uppercase; 
            display: block; 
            margin-bottom: 8px;
            letter-spacing: 1px;
        }
        .info-box .value { 
            color: #e0e0e0; 
            font-size: 16px;
            font-weight: bold;
        }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .page-title { 
            color: #d4af37; 
            font-size: 28px; 
            margin-bottom: 25px; 
            border-bottom: 3px solid #d4af37; 
            padding-bottom: 15px;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
        }
        .form-group { margin-bottom: 20px; }
        .form-group label { 
            display: block; 
            color: #d4af37; 
            font-weight: bold; 
            margin-bottom: 8px; 
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .form-group input, .form-group select, .form-group textarea { 
            width: 100%; 
            padding: 12px; 
            background: linear-gradient(90deg, rgba(212, 175, 55, 0.05) 0%, rgba(212, 175, 55, 0.1) 100%);
            border: 2px solid rgba(212, 175, 55, 0.3); 
            color: #e0e0e0; 
            border-radius: 6px; 
            font-family: inherit; 
            font-size: 13px;
            transition: all 0.3s ease;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { 
            outline: none; 
            background: linear-gradient(90deg, rgba(212, 175, 55, 0.15) 0%, rgba(212, 175, 55, 0.25) 100%);
            border-color: #d4af37;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.4); 
        }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .btn { 
            padding: 12px 24px; 
            border: 2px solid #d4af37; 
            background: linear-gradient(90deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%);
            color: #d4af37; 
            cursor: pointer; 
            border-radius: 6px; 
            font-weight: bold; 
            transition: all 0.3s ease; 
            font-size: 13px; 
            text-transform: uppercase; 
            letter-spacing: 1px;
        }
        .btn:hover { 
            background: linear-gradient(90deg, #d4af37 0%, #e0c158 100%);
            color: #0d0d1a; 
            transform: translateY(-3px); 
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.4); 
        }
        .btn-primary { 
            background: linear-gradient(90deg, #d4af37 0%, #e0c158 100%);
            color: #0d0d1a; 
            border-color: #d4af37;
            font-weight: bold;
        }
        .btn-primary:hover { 
            background: linear-gradient(90deg, #e0c158 0%, #f0d168 100%);
            border-color: #e0c158;
            box-shadow: 0 10px 25px rgba(212, 175, 55, 0.5);
        }
        .btn-group { display: flex; gap: 10px; margin-top: 20px; flex-wrap: wrap; }
        .action-card { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.12) 0%, rgba(212, 175, 55, 0.05) 100%); 
            border: 2px solid rgba(212, 175, 55, 0.4); 
            padding: 20px; 
            border-radius: 10px; 
            cursor: pointer; 
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.1);
        }
        .action-card:hover { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(212, 175, 55, 0.1) 100%); 
            transform: translateY(-5px); 
            box-shadow: 0 12px 30px rgba(212, 175, 55, 0.25);
            border-color: #d4af37;
        }
        .action-card h3 { 
            color: #d4af37; 
            margin-bottom: 10px; 
            font-size: 16px;
            text-shadow: 0 0 5px rgba(212, 175, 55, 0.3);
        }
        .action-card p { 
            color: #b0b0b0; 
            font-size: 12px; 
            margin-bottom: 10px; 
        }
        .action-card .effect { 
            color: #4caf50; 
            font-size: 11px; 
            font-weight: bold;
        }
        .stats-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); 
            gap: 15px; 
            margin-bottom: 30px; 
        }
        .stat-box { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.12) 0%, rgba(212, 175, 55, 0.05) 100%);
            border: 2px solid rgba(212, 175, 55, 0.4); 
            padding: 20px; 
            border-radius: 10px; 
            text-align: center;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.1);
            transition: all 0.3s ease;
        }
        .stat-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.2);
        }
        .stat-box h4 { 
            color: #d4af37; 
            font-size: 11px; 
            text-transform: uppercase; 
            margin-bottom: 10px;
            letter-spacing: 1px;
        }
        .stat-box .value { 
            color: #e0e0e0; 
            font-size: 28px; 
            font-weight: bold;
        }
        .skill-bar { 
            background: rgba(0, 0, 0, 0.6); 
            border: 2px solid rgba(212, 175, 55, 0.3); 
            height: 25px; 
            border-radius: 6px; 
            overflow: hidden; 
            margin-bottom: 10px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        .skill-progress { 
            height: 100%; 
            background: linear-gradient(90deg, #4caf50 0%, #8bc34a 50%, #cddc39 100%); 
            width: 0%; 
            transition: width 0.3s ease; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #000; 
            font-weight: bold; 
            font-size: 11px;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }
        .modal { 
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background-color: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(3px);
        }
        .modal.active { 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            animation: modalFadeIn 0.3s ease;
        }
        @keyframes modalFadeIn { from { opacity: 0; } to { opacity: 1; } }
        .modal-content { 
            background: linear-gradient(135deg, #1a1a2e 0%, #2d2d4a 100%); 
            border: 3px solid #d4af37; 
            padding: 30px; 
            border-radius: 10px; 
            max-width: 600px; 
            width: 90%; 
            max-height: 80vh; 
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(212, 175, 55, 0.3);
        }
        .modal-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 20px; 
            border-bottom: 2px solid #d4af37; 
            padding-bottom: 15px; 
        }
        .modal-header h2 { 
            color: #d4af37; 
            font-size: 24px;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
        }
        .close-btn { 
            background: none; 
            border: none; 
            color: #d4af37; 
            font-size: 28px; 
            cursor: pointer; 
            transition: all 0.3s ease; 
        }
        .close-btn:hover { 
            color: #e0c158; 
            transform: scale(1.3); 
        }
        .modal-body { 
            color: #e0e0e0; 
            margin-bottom: 20px; 
            line-height: 1.8; 
            font-size: 13px;
        }
        .modal-footer { 
            display: flex; 
            gap: 10px; 
            justify-content: flex-end; 
        }
        .journal-entry { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%);
            border-left: 4px solid #d4af37; 
            padding: 15px; 
            margin-bottom: 15px; 
            border-radius: 6px;
            box-shadow: 0 4px 10px rgba(212, 175, 55, 0.1);
        }
        .journal-entry .date { 
            color: #d4af37; 
            font-weight: bold; 
            font-size: 11px; 
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .journal-entry .content { 
            color: #e0e0e0; 
            margin-top: 8px;
            font-size: 12px;
        }
        .action-counter { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(212, 175, 55, 0.05) 100%);
            border: 2px solid #d4af37; 
            padding: 15px; 
            border-radius: 8px; 
            margin-bottom: 20px; 
            color: #d4af37; 
            font-weight: bold; 
            text-align: center;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.1);
        }
        .exp-bar { 
            background: rgba(0, 0, 0, 0.6); 
            border: 2px solid rgba(255, 152, 0, 0.3); 
            height: 30px; 
            border-radius: 6px; 
            overflow: hidden; 
            margin-bottom: 10px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        .exp-progress { 
            height: 100%; 
            background: linear-gradient(90deg, #ff9800 0%, #ffc107 50%, #ffeb3b 100%); 
            width: 0%; 
            transition: width 0.3s ease; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #000; 
            font-weight: bold; 
            font-size: 12px;
            box-shadow: 0 0 10px rgba(255, 152, 0, 0.5);
        }
        .message-box { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%);
            border: 2px solid rgba(212, 175, 55, 0.3); 
            padding: 15px; 
            margin-bottom: 15px; 
            border-radius: 6px;
            border-left: 4px solid #ff9800;
            box-shadow: 0 4px 10px rgba(212, 175, 55, 0.1);
        }
        .message-box .sender { 
            color: #ff9800; 
            font-weight: bold; 
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .message-box .content { 
            color: #e0e0e0; 
            margin-top: 8px;
            font-size: 12px;
        }
        .location-card { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.12) 0%, rgba(212, 175, 55, 0.05) 100%);
            border: 2px solid rgba(212, 175, 55, 0.4); 
            padding: 15px; 
            border-radius: 8px; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            margin-bottom: 12px;
            box-shadow: 0 4px 10px rgba(212, 175, 55, 0.1);
        }
        .location-card:hover { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(212, 175, 55, 0.1) 100%);
            transform: translateX(5px); 
            border-color: #d4af37;
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.2);
        }
        .location-card h3 { 
            color: #d4af37; 
            margin-bottom: 6px; 
            font-size: 14px;
        }
        .location-card p { 
            color: #b0b0b0; 
            font-size: 11px; 
        }
        .npc-card { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%);
            border: 2px solid rgba(212, 175, 55, 0.3); 
            padding: 15px; 
            border-radius: 6px; 
            margin-bottom: 12px;
            box-shadow: 0 4px 10px rgba(212, 175, 55, 0.1);
        }
        .npc-card .name { 
            color: #d4af37; 
            font-weight: bold; 
            font-size: 13px;
        }
        .npc-card .relation { 
            color: #b0b0b0; 
            font-size: 11px; 
            margin-top: 4px;
        }
        .npc-card .actions { 
            margin-top: 10px; 
            display: flex; 
            gap: 8px; 
        }
        .npc-card .actions button { 
            padding: 6px 12px; 
            font-size: 11px; 
        }
        .inventory-item { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%);
            border: 2px solid rgba(212, 175, 55, 0.3); 
            padding: 12px; 
            border-radius: 6px; 
            margin-bottom: 10px;
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            box-shadow: 0 4px 10px rgba(212, 175, 55, 0.1);
        }
        .inventory-item .name { 
            color: #d4af37; 
            font-weight: bold; 
            font-size: 13px;
        }
        .inventory-item .quantity { 
            color: #b0b0b0; 
            font-size: 12px; 
        }
        .decoration-card { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.12) 0%, rgba(212, 175, 55, 0.05) 100%);
            border: 2px solid rgba(212, 175, 55, 0.4); 
            padding: 15px; 
            border-radius: 8px; 
            margin-bottom: 12px;
            box-shadow: 0 4px 10px rgba(212, 175, 55, 0.1);
        }
        .decoration-card h3 { 
            color: #d4af37; 
            margin-bottom: 6px; 
            font-size: 14px;
        }
        .decoration-card p { 
            color: #b0b0b0; 
            font-size: 11px; 
        }
        .mission-card { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.12) 0%, rgba(212, 175, 55, 0.05) 100%);
            border: 2px solid rgba(212, 175, 55, 0.4); 
            padding: 20px; 
            border-radius: 10px; 
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.1);
        }
        .mission-card h3 { 
            color: #d4af37; 
            margin-bottom: 10px; 
            font-size: 16px;
        }
        .mission-card p { 
            color: #b0b0b0; 
            font-size: 12px; 
            margin-bottom: 15px; 
        }
        .mission-card .reward { 
            color: #4caf50; 
            font-size: 12px; 
            font-weight: bold;
        }
        .mission-card .actions { 
            margin-top: 15px; 
            display: flex; 
            gap: 10px; 
        }
        .career-entry { 
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%);
            border-left: 4px solid #d4af37; 
            padding: 15px; 
            margin-bottom: 15px; 
            border-radius: 6px;
            box-shadow: 0 4px 10px rgba(212, 175, 55, 0.1);
        }
        .career-entry .date { 
            color: #d4af37; 
            font-weight: bold; 
            font-size: 11px; 
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .career-entry .rank { 
            color: #e0e0e0; 
            margin-top: 8px;
            font-size: 14px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <button id="sidebarToggle">&#9776;</button>
            <h1>Eisernes Kreuz</h1>
            <div class="nav-section">
                <h3>G√©n√©ral</h3>
                <button class="nav-button active" onclick="showPage('dashboard')">Tableau de Bord</button>
                <button class="nav-button" onclick="showPage('actions')">Actions</button>
                <button class="nav-button" onclick="showPage('missions')">Missions</button>
            </div>
            <div class="nav-section">
                <h3>Personnage</h3>
                <button class="nav-button" onclick="showPage('career')">Carri√®re</button>
                <button class="nav-button" onclick="showPage('skills')">Comp√©tences</button>
                <button class="nav-button" onclick="showPage('inventory')">Inventaire</button>
                <button class="nav-button" onclick="showPage('decorations')">D√©corations</button>
            </div>
            <div class="nav-section">
                <h3>Social</h3>
                <button class="nav-button" onclick="showPage('relations')">Relations</button>
                <button class="nav-button" onclick="showPage('messages')">Messages</button>
            </div>
            <div class="nav-section">
                <h3>Monde</h3>
                <button class="nav-button" onclick="showPage('map')">Carte</button>
            </div>
            <div class="nav-section">
                <h3>Sant√©</h3>
                <button class="nav-button" onclick="showPage('health')">Physique</button>
                <button class="nav-button" onclick="showPage('mental')">Mental</button>
            </div>
            <div class="nav-section">
                <h3>Autres</h3>
                <button class="nav-button" onclick="showPage('journal')">Journal</button>
                <button class="nav-button" onclick="resetGame()">Nouvelle Partie</button>
            </div>
        </div>

        <div class="main-content">
            <!-- PAGE CR√âATION -->
            <div id="creation" class="page active">
                <div class="header">
                    <h1>Cr√©ation de Personnage</h1>
                    <p>Configurez votre officier pour commencer votre simulation (1933-1945)</p>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Nom Complet</label>
                        <input type="text" id="playerName" placeholder="Ex: Klaus Weber" value="">
                    </div>
                    <div class="form-group">
                        <label>Date de Naissance</label>
                        <input type="date" id="birthDate" value="1915-01-01">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>R√©gion d'Origine</label>
                        <select id="region">
                            <option value="prussie">Prusse</option>
                            <option value="baviere">Bavi√®re</option>
                            <option value="saxe">Saxe</option>
                            <option value="rheinland">Rh√©nanie</option>
                            <option value="autriche">Autriche</option>
                            <option value="sudetes">Sud√®tes</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Parcours √âducatif</label>
                        <select id="education">
                            <option value="hitlerjugend">Jeunesses Hitl√©riennes</option>
                            <option value="universite">Universit√©</option>
                            <option value="usine">Usine d'Armement</option>
                            <option value="campagne">Campagne</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Branche Militaire</label>
                        <select id="branch">
                            <option value="heer">Heer (Arm√©e de Terre)</option>
                            <option value="luftwaffe">Luftwaffe (Aviation)</option>
                            <option value="kriegsmarine">Kriegsmarine (Marine)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Sp√©cialisation</label>
                        <select id="specialization">
                            <option value="infanterie">Infanterie</option>
                            <option value="panzer">Panzer</option>
                            <option value="artillerie">Artillerie</option>
                            <option value="reconnaissance">Reconnaissance</option>
                            <option value="genie">G√©nie</option>
                            <option value="transmissions">Transmissions</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Notes Personnelles</label>
                    <textarea id="notes" placeholder="Vos ambitions..." rows="4"></textarea>
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="startGame()">Commencer</button>
                    <button class="btn" onclick="loadGame()">Charger</button>
                </div>
            </div>

            <!-- PAGE TABLEAU DE BORD -->
            <div id="dashboard" class="page">
                <div class="header">
                    <h1 id="dashboardTitle">Tableau de Bord</h1>
                    <div class="player-info">
                        <div class="info-box">
                            <label>Nom</label>
                            <div class="value" id="dashboardName">-</div>
                        </div>
                        <div class="info-box">
                            <label>Rang</label>
                            <div class="value" id="dashboardRank">-</div>
                        </div>
                        <div class="info-box">
                            <label>Branche</label>
                            <div class="value" id="dashboardBranch">-</div>
                        </div>
                        <div class="info-box">
                            <label>Date</label>
                            <div class="value" id="dashboardDate">-</div>
                        </div>
                        <div class="info-box">
                            <label>Sant√©</label>
                            <div class="value" id="dashboardHealth">100%</div>
                        </div>
                        <div class="info-box">
                            <label>Moral</label>
                            <div class="value" id="dashboardMoral">100%</div>
                        </div>
                    </div>
                </div>

                <h2 class="page-title">Exp√©rience et Progression</h2>
                <div style="background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%); border: 2px solid rgba(212, 175, 55, 0.3); padding: 20px; border-radius: 8px; margin-bottom: 25px; box-shadow: 0 4px 15px rgba(212, 175, 55, 0.1);">
                    <p style="color: #d4af37; font-weight: bold; margin-bottom: 12px; font-size: 14px;">Exp√©rience: <span id="currentXP">0</span> / <span id="nextRankXP">1000</span></p>
                    <div class="exp-bar">
                        <div class="exp-progress" id="expBar" style="width: 0%;"></div>
                    </div>
                    <p style="color: #b0b0b0; font-size: 12px;">Progression vers le prochain grade</p>
                </div>

                <h2 class="page-title">Actions Rapides</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px; margin-bottom: 25px;">
                    <button class="btn btn-primary" onclick="advanceDay()">Jour Suivant</button>
                    <button class="btn btn-primary" onclick="advanceWeek()">Semaine</button>
                    <button class="btn btn-primary" onclick="advanceMonth()">Mois</button>
                    <button class="btn" onclick="saveGame()">Sauvegarder</button>
                </div>

                <h2 class="page-title">Statistiques</h2>
                <div class="stats-grid">
                    <div class="stat-box">
                        <h4>Jours Servis</h4>
                        <div class="value" id="daysServed">0</div>
                    </div>
                    <div class="stat-box">
                        <h4>Missions</h4>
                        <div class="value" id="missionsCompleted">0</div>
                    </div>
                    <div class="stat-box">
                        <h4>Combats</h4>
                        <div class="value" id="combatsParticipated">0</div>
                    </div>
                    <div class="stat-box">
                        <h4>D√©corations</h4>
                        <div class="value" id="totalDecorations">0</div>
                    </div>
                    <div class="stat-box">
                        <h4>Blessures</h4>
                        <div class="value" id="totalWounds">0</div>
                    </div>
                    <div class="stat-box">
                        <h4>Promotions</h4>
                        <div class="value" id="totalPromotions">0</div>
                    </div>
                </div>
            </div>

            <!-- PAGE ACTIONS -->
            <div id="actions" class="page">
                <div class="header">
                    <h1>Actions Quotidiennes</h1>
                </div>
                <div class="action-counter">
                    Actions disponibles: <span id="actionsRemaining">2</span> / <span id="maxActions">2</span>
                </div>
                <h2 class="page-title">Activit√©s</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div class="action-card" onclick="performAction('patrol')">
                        <h3>üö∂ Patrouille</h3>
                        <p>Patrouille de routine avec votre unit√©</p>
                        <div class="effect">+50 XP, +Tactique, +Survie</div>
                    </div>
                    <div class="action-card" onclick="performAction('training')">
                        <h3>üí™ Entra√Ænement</h3>
                        <p>Combat rapproch√© intensif</p>
                        <div class="effect">+75 XP, +M√™l√©e, +Force</div>
                    </div>
                    <div class="action-card" onclick="performAction('shooting')">
                        <h3>üéØ Tir</h3>
                        <p>Tir √† la cible et pr√©cision</p>
                        <div class="effect">+75 XP, +Tir, +Pr√©cision</div>
                    </div>
                    <div class="action-card" onclick="performAction('study')">
                        <h3>üìö √âtude</h3>
                        <p>√âtude tactique et strat√©gie</p>
                        <div class="effect">+100 XP, +Tactique, +Leadership</div>
                    </div>
                    <div class="action-card" onclick="performAction('inspection')">
                        <h3>üîç Inspection</h3>
                        <p>Diriger et inspecter les troupes</p>
                        <div class="effect">+60 XP, +Leadership, +Discipline</div>
                    </div>
                    <div class="action-card" onclick="performAction('rest')">
                        <h3>üò¥ Repos</h3>
                        <p>R√©cup√©ration et repos</p>
                        <div class="effect">+Sant√©, -Stress, +Moral</div>
                    </div>
                    <div class="action-card" onclick="performAction('maintenance')">
                        <h3>üîß Maintenance</h3>
                        <p>Entretien d'√©quipement</p>
                        <div class="effect">+50 XP, +M√©canique, +Technique</div>
                    </div>
                    <div class="action-card" onclick="performAction('socializing')">
                        <h3>üçª Socialisation</h3>
                        <p>Passer du temps avec les camarades</p>
                        <div class="effect">+40 XP, +Relations, +Moral</div>
                    </div>
                </div>
            </div>

            <!-- PAGE CARRI√àRE -->
            <div id="career" class="page">
                <div class="header">
                    <h1>Carri√®re Militaire</h1>
                </div>
                <h2 class="page-title">Historique des Promotions</h2>
                <div id="promotionHistory"></div>
            </div>

            <!-- PAGE COMP√âTENCES -->
            <div id="skills" class="page">
                <div class="header">
                    <h1>Comp√©tences</h1>
                </div>
                <div class="stats-grid">
                    <div class="stat-box">
                        <h4>Tir</h4>
                        <div class="skill-bar"><div class="skill-progress" id="skillShooting"></div></div>
                        <div class="value" id="skillShootingLevel"></div>
                    </div>
                    <div class="stat-box">
                        <h4>M√™l√©e</h4>
                        <div class="skill-bar"><div class="skill-progress" id="skillMelee"></div></div>
                        <div class="value" id="skillMeleeLevel"></div>
                    </div>
                    <div class="stat-box">
                        <h4>Tactique</h4>
                        <div class="skill-bar"><div class="skill-progress" id="skillTactics"></div></div>
                        <div class="value" id="skillTacticsLevel"></div>
                    </div>
                    <div class="stat-box">
                        <h4>Leadership</h4>
                        <div class="skill-bar"><div class="skill-progress" id="skillLeadership"></div></div>
                        <div class="value" id="skillLeadershipLevel"></div>
                    </div>
                    <div class="stat-box">
                        <h4>Survie</h4>
                        <div class="skill-bar"><div class="skill-progress" id="skillSurvival"></div></div>
                        <div class="value" id="skillSurvivalLevel"></div>
                    </div>
                    <div class="stat-box">
                        <h4>M√©canique</h4>
                        <div class="skill-bar"><div class="skill-progress" id="skillMechanics"></div></div>
                        <div class="value" id="skillMechanicsLevel"></div>
                    </div>
                </div>
            </div>

            <!-- PAGE INVENTAIRE -->
            <div id="inventory" class="page">
                <div class="header">
                    <h1>Inventaire</h1>
                </div>
                <div id="inventoryList"></div>
            </div>

            <!-- PAGE D√âCORATIONS -->
            <div id="decorations" class="page">
                <div class="header">
                    <h1>D√©corations</h1>
                </div>
                <div id="decorationsList"></div>
            </div>

            <!-- PAGE RELATIONS -->
            <div id="relations" class="page">
                <div class="header">
                    <h1>Relations</h1>
                </div>
                <div id="relationsList"></div>
            </div>

            <!-- PAGE MESSAGES -->
            <div id="messages" class="page">
                <div class="header">
                    <h1>Messages</h1>
                </div>
                <div id="messagesList"></div>
            </div>

            <!-- PAGE CARTE -->
            <div id="map" class="page">
                <div class="header">
                    <h1>Carte de l'Europe</h1>
                </div>
                <div id="mapContainer"></div>
            </div>

            <!-- PAGE SANT√â -->
            <div id="health" class="page">
                <div class="header">
                    <h1>Sant√© Physique</h1>
                </div>
                <div class="stats-grid">
                    <div class="stat-box">
                        <h4>Sant√© Globale</h4>
                        <div class="skill-bar"><div class="skill-progress" id="globalHealth"></div></div>
                        <div class="value" id="globalHealthStatus"></div>
                    </div>
                    <div class="stat-box">
                        <h4>T√™te</h4>
                        <div class="skill-bar"><div class="skill-progress" id="healthHead"></div></div>
                        <div class="value" id="healthHeadStatus"></div>
                    </div>
                    <div class="stat-box">
                        <h4>Torse</h4>
                        <div class="skill-bar"><div class="skill-progress" id="healthChest"></div></div>
                        <div class="value" id="healthChestStatus"></div>
                    </div>
                    <div class="stat-box">
                        <h4>Bras Droit</h4>
                        <div class="skill-bar"><div class="skill-progress" id="healthArmRight"></div></div>
                        <div class="value" id="healthArmRightStatus"></div>
                    </div>
                    <div class="stat-box">
                        <h4>Jambe Droite</h4>
                        <div class="skill-bar"><div class="skill-progress" id="healthLegRight"></div></div>
                        <div class="value" id="healthLegRightStatus"></div>
                    </div>
                </div>
            </div>

            <!-- PAGE MENTAL -->
            <div id="mental" class="page">
                <div class="header">
                    <h1>Sant√© Mentale</h1>
                </div>
                <div class="stats-grid">
                    <div class="stat-box">
                        <h4>Moral</h4>
                        <div class="skill-bar"><div class="skill-progress" id="mentalMoral"></div></div>
                        <div class="value" id="mentalMoralStatus"></div>
                    </div>
                    <div class="stat-box">
                        <h4>Stress</h4>
                        <div class="skill-bar"><div class="skill-progress" id="mentalStress"></div></div>
                        <div class="value" id="mentalStressStatus"></div>
                    </div>
                    <div class="stat-box">
                        <h4>R√©silience</h4>
                        <div class="skill-bar"><div class="skill-progress" id="mentalResilience"></div></div>
                        <div class="value" id="mentalResilienceStatus"></div>
                    </div>
                </div>
            </div>

            <!-- PAGE JOURNAL -->
            <div id="journal" class="page">
                <div class="header">
                    <h1>Journal de Marche</h1>
                </div>
                <div id="journalEntries"></div>
            </div>

            <!-- PAGE MISSIONS -->
            <div id="missions" class="page">
                <div class="header">
                    <h1>Missions</h1>
                </div>
                <div id="missionsList"></div>
            </div>
        </div>
    </div>

    <!-- MODAL -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle"></h2>
                <span class="close-btn" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body" id="modalBody"></div>
            <div class="modal-footer" id="modalFooter"></div>
        </div>
    </div>

    <script>
        // ===== DONN√âES DU JEU =====
        const RANKS = [
            'Sch√ºtze', 'Obersch√ºtze', 'Gefreiter', 'Obergefreiter', 'Stabsgefreiter',
            'Unteroffizier', 'Unterfeldwebel', 'Feldwebel', 'Oberfeldwebel', 'Stabsfeldwebel',
            'Leutnant', 'Oberleutnant', 'Hauptmann', 'Major', 'Oberstleutnant', 'Oberst',
            'Generalmajor', 'Generalleutnant', 'General', 'Generaloberst', 'Generalfeldmarschall'
        ];

        const DECORATIONS = [
            { name: 'Croix de Fer 2e Classe', criteria: { combats: 5, moral: 60 } },
            { name: 'Croix de Fer 1re Classe', criteria: { combats: 15, moral: 70 } },
            { name: 'Croix de Chevalier', criteria: { combats: 30, moral: 80, leadership: 60 } },
            { name: 'Insigne des Bless√©s (Noir)', criteria: { wounds: 1 } },
            { name: 'Insigne des Bless√©s (Argent)', criteria: { wounds: 3 } },
            { name: 'Insigne des Bless√©s (Or)', criteria: { wounds: 5 } }
        ];

        const NPCS = [
            { name: 'M√®re', relation: 'Famille' },
            { name: 'P√®re', relation: 'Famille' },
            { name: 'Hans (Camarade)', relation: 'Unit√©' },
            { name: 'Fritz (Camarade)', relation: 'Unit√©' },
            { name: 'Commandant', relation: 'Sup√©rieur' }
        ];

        const LOCATIONS = [
            { name: 'Berlin', country: 'Allemagne', x: 52.52, y: 13.40 },
            { name: 'Munich', country: 'Allemagne', x: 48.13, y: 11.58 },
            { name: 'Varsovie', country: 'Pologne', x: 52.22, y: 21.01 },
            { name: 'Paris', country: 'France', x: 48.85, y: 2.35 },
            { name: 'Stalingrad', country: 'URSS', x: 48.70, y: 44.51 },
            { name: 'Madrid', country: 'Espagne', x: 40.41, y: -3.70 }
        ];

        const HISTORICAL_EVENTS = [
            { date: new Date(1936, 6, 18), name: 'Guerre civile espagnole', description: 'La guerre civile espagnole √©clate. Vous pouvez vous porter volontaire pour la L√©gion Condor.' },
            { date: new Date(1938, 2, 12), name: 'Anschluss', description: 'L\'Allemagne annexe l\'Autriche.' },
            { date: new Date(1939, 8, 1), name: 'Invasion de la Pologne', description: 'L\'Allemagne envahit la Pologne, d√©clenchant la Seconde Guerre mondiale.' },
            { date: new Date(1940, 4, 10), name: 'Bataille de France', description: 'L\'Allemagne envahit la France.' },
            { date: new Date(1941, 5, 22), name: 'Op√©ration Barbarossa', description: 'L\'Allemagne envahit l\'Union sovi√©tique.' },
            { date: new Date(1942, 7, 23), name: 'Bataille de Stalingrad', description: 'La bataille de Stalingrad commence.' },
            { date: new Date(1944, 5, 6), name: 'D√©barquement de Normandie', description: 'Les Alli√©s d√©barquent en Normandie.' },
            { date: new Date(1945, 4, 8), name: 'Fin de la guerre en Europe', description: 'L\'Allemagne capitule. La guerre est finie.' }
        ];

        const OLD_LOCATIONS = [
            { name: 'Berlin', country: 'Allemagne' },
            { name: 'Munich', country: 'Allemagne' },
            { name: 'Varsovie', country: 'Pologne' },
            { name: 'Paris', country: 'France' },
            { name: 'Stalingrad', country: 'URSS' }
        ];

        const PEACE_MISSIONS = [
            { id: 'peace_1', name: 'Entra√Ænement de base', description: 'Participez √† un entra√Ænement de base pour am√©liorer vos comp√©tences.', reward: { xp: 100 } },
            { id: 'peace_2', name: 'Man≈ìuvres militaires', description: 'Participez √† des man≈ìuvres militaires pour tester vos comp√©tences.', reward: { xp: 200 } },
            { id: 'peace_3', name: 'Garde de caserne', description: 'Effectuez une garde de caserne.', reward: { xp: 50 } },
        ];

        const WAR_MISSIONS = [
            { id: 'war_1', name: 'Patrouille de reconnaissance', description: 'Effectuez une patrouille de reconnaissance en territoire ennemi.', reward: { xp: 500 } },
            { id: 'war_2', name: 'Assaut frontal', description: 'Menez un assaut frontal contre une position ennemie.', reward: { xp: 1000 } },
            { id: 'war_3', name: 'D√©fense de position', description: 'D√©fendez une position contre une attaque ennemie.', reward: { xp: 750 } },
        ];

        const INVENTORY_ITEMS = [
            { name: 'Fusil Kar98k', type: 'weapon', quantity: 1 },
            { name: 'Pistolet Luger P08', type: 'weapon', quantity: 1 },
            { name: 'Ba√Øonnette', type: 'weapon', quantity: 1 }
        ];

        // ===== √âTAT DU JEU =====
        let gameState = {
            player: {
                name: '', rank: 0, experience: 0, health: 100, moral: 100, stress: 0,
                daysServed: 0, missionsCompleted: 0, combatsParticipated: 0, totalWounds: 0, totalPromotions: 0,
                decorations: [], skills: { shooting: 0, melee: 0, tactics: 0, leadership: 0, survival: 0, mechanics: 0 },
                health_parts: { head: 100, chest: 100, armRight: 100, legRight: 100 },
                mental: { moral: 100, stress: 0, resilience: 50 },
                relations: {}, messages: [], journal: [], inventory: INVENTORY_ITEMS.slice(),
                location: 'Berlin', branch: '', specialization: '', promotionHistory: []
            },
            gameStarted: false,
            currentDate: new Date(1933, 0, 30),
            actionsToday: 0,
            maxActionsPerDay: 2,
            isWarTime: false,
            isPeaceTime: true
        };

        // ===== FONCTIONS PRINCIPALES =====
        function showPage(pageId) {
            if (!gameState.gameStarted && pageId !== 'creation') {
                showModal('Jeu non commenc√©', 'Veuillez d\'abord cr√©er un personnage.');
                return;
            }
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            document.querySelectorAll('.nav-button').forEach(b => b.classList.remove('active'));
            const buttons = document.querySelectorAll('.nav-button');
            buttons.forEach(btn => {
                if (btn.textContent.toLowerCase().includes(pageId.toLowerCase()) || 
                    (pageId === 'dashboard' && btn.textContent.includes('Tableau')) ||
                    (pageId === 'actions' && btn.textContent === 'Actions') ||
                    (pageId === 'missions' && btn.textContent === 'Missions') ||
                    (pageId === 'career' && btn.textContent === 'Carri√®re') ||
                    (pageId === 'skills' && btn.textContent === 'Comp√©tences') ||
                    (pageId === 'inventory' && btn.textContent === 'Inventaire') ||
                    (pageId === 'decorations' && btn.textContent === 'D√©corations') ||
                    (pageId === 'relations' && btn.textContent === 'Relations') ||
                    (pageId === 'messages' && btn.textContent === 'Messages') ||
                    (pageId === 'map' && btn.textContent === 'Carte') ||
                    (pageId === 'health' && btn.textContent === 'Physique') ||
                    (pageId === 'mental' && btn.textContent === 'Mental') ||
                    (pageId === 'journal' && btn.textContent === 'Journal')) {
                    btn.classList.add('active');
                }
            });
            if (pageId === 'dashboard' && gameState.gameStarted) updateDashboard();
            if (pageId === 'relations' && gameState.gameStarted) updateRelations();
            if (pageId === 'messages' && gameState.gameStarted) updateMessages();
            if (pageId === 'inventory' && gameState.gameStarted) updateInventory();
            if (pageId === 'map' && gameState.gameStarted) updateMap();
            if (pageId === 'missions' && gameState.gameStarted) updateMissions();
            if (pageId === 'career' && gameState.gameStarted) updateCareer();
        }

        function startGame() {
            const name = document.getElementById('playerName').value;
            if (!name) { alert('Veuillez entrer un nom'); return; }
            gameState.player.name = name;
            gameState.player.branch = document.getElementById('branch').value;
            gameState.player.specialization = document.getElementById('specialization').value;
            gameState.gameStarted = true;
            gameState.currentDate = new Date(1933, 0, 30);
            gameState.isWarTime = false;
            NPCS.forEach(npc => { gameState.player.relations[npc.name] = 50; });
            addJournalEntry('D√©but de la simulation - Vous √™tes recrut√© dans l\'arm√©e allemande');
            updateDashboard();
            showPage('dashboard');
            saveGame();
        }

        function updateDashboard() {
            document.getElementById('dashboardName').textContent = gameState.player.name;
            document.getElementById('dashboardRank').textContent = RANKS[gameState.player.rank] || '-';
            document.getElementById('dashboardBranch').textContent = gameState.player.branch.toUpperCase();
            document.getElementById('dashboardDate').textContent = gameState.currentDate.toLocaleDateString('fr-FR');
            document.getElementById('dashboardHealth').textContent = Math.floor(gameState.player.health) + '%';
            document.getElementById('dashboardMoral').textContent = Math.floor(gameState.player.mental.moral) + '%';
            document.getElementById('daysServed').textContent = gameState.player.daysServed;
            document.getElementById('missionsCompleted').textContent = gameState.player.missionsCompleted;
            document.getElementById('combatsParticipated').textContent = gameState.player.combatsParticipated;
            document.getElementById('totalWounds').textContent = gameState.player.totalWounds;
            document.getElementById('totalPromotions').textContent = gameState.player.totalPromotions;
            document.getElementById('totalDecorations').textContent = gameState.player.decorations.length;
            document.getElementById('currentXP').textContent = Math.floor(gameState.player.experience);
            document.getElementById('nextRankXP').textContent = (gameState.player.rank + 1) * 1000;
            document.getElementById('expBar').style.width = (gameState.player.experience % 1000) / 10 + '%';
            document.getElementById('actionsRemaining').textContent = gameState.maxActionsPerDay - gameState.actionsToday;
            document.getElementById('maxActions').textContent = gameState.maxActionsPerDay;
            updateSkills();
            updateHealth();
            updateMental();
        }

        function advanceDay() {
            gameState.currentDate.setDate(gameState.currentDate.getDate() + 1);
            gameState.player.daysServed += 1;
            gameState.player.experience += Math.random() * 10;
            gameState.player.mental.stress += Math.random() * 2;
            gameState.player.mental.moral -= Math.random() * 1;
            if (gameState.player.mental.stress > 100) gameState.player.mental.stress = 100;
            if (gameState.player.mental.stress < 0) gameState.player.mental.stress = 0;
            if (gameState.player.mental.moral < 0) gameState.player.mental.moral = 0;
            gameState.actionsToday = 0;
HISTORICAL_EVENTS.forEach(event => {
                if (event.date.getTime() === gameState.currentDate.getTime()) {
                    addJournalEntry(`√âv√©nement historique : ${event.name} - ${event.description}`);
                    showModal(`√âv√©nement historique : ${event.name}`, event.description);
                }
            });

            if (gameState.currentDate.getFullYear() >= 1939 && gameState.currentDate.getMonth() >= 8 && gameState.currentDate.getDate() >= 1) {
                gameState.isWarTime = true;
                gameState.isPeaceTime = false;
                addJournalEntry("La Seconde Guerre mondiale a commenc√©!");
            } else {
                gameState.isWarTime = false;
                gameState.isPeaceTime = true;
            }
            checkPromotion();
            updateDashboard();
            saveGame();
        }

        function advanceWeek() {
            for (let i = 0; i < 7; i++) advanceDay();
        }

        function advanceMonth() {
            for (let i = 0; i < 30; i++) advanceDay();
        }

        function performAction(action) {
            if (gameState.actionsToday >= gameState.maxActionsPerDay) {
                showModal('Limite d\'actions', 'Vous avez atteint le nombre maximum d\'actions pour aujourd\'hui.');
                return;
            }
            const actions = {
                heer: {
                    patrol: { xp: 50, skills: ["tactics"], moral: 10, stress: -5 },
                    training: { xp: 75, skills: ["melee"], moral: 5, stress: 10 },
                },
                luftwaffe: {
                    reconnaissance: { xp: 100, skills: ["tactics"], moral: 15, stress: -10 },
                    dogfight: { xp: 150, skills: ["shooting"], moral: 20, stress: 20 },
                },
                kriegsmarine: {
                    patrol: { xp: 60, skills: ["tactics"], moral: 10, stress: -5 },
                    gunnery: { xp: 120, skills: ["shooting"], moral: 15, stress: 15 },
                }
            };

            const old_actions = {
                patrol: { xp: 50, skills: ['tactics'], moral: 10, stress: -5 },
                training: { xp: 75, skills: ['melee'], moral: 5, stress: 10 },
                shooting: { xp: 75, skills: ['shooting'], moral: 5, stress: 10 },
                study: { xp: 100, skills: ['tactics', 'leadership'], moral: 0, stress: 15 },
                inspection: { xp: 60, skills: ['leadership'], moral: 20, stress: 5 },
                rest: { xp: 20, skills: [], moral: 30, stress: -20, health: 20 },
                maintenance: { xp: 50, skills: ['mechanics'], moral: 5, stress: 0 },
                socializing: { xp: 40, skills: ['leadership'], moral: 40, stress: -10 }
            };
            const act = actions[gameState.player.branch][action];
            if (!act) return;
            gameState.player.experience += act.xp;
            gameState.player.mental.moral += act.moral;
            gameState.player.mental.stress += act.stress;
            if (gameState.player.health < 100 && act.health) gameState.player.health = Math.min(100, gameState.player.health + act.health);
            if (gameState.player.mental.moral > 100) gameState.player.mental.moral = 100;
            if (gameState.player.mental.stress > 100) gameState.player.mental.stress = 100;
            if (gameState.player.mental.stress < 0) gameState.player.mental.stress = 0;
            act.skills.forEach(skill => {
                gameState.player.skills[skill] = Math.min(100, gameState.player.skills[skill] + Math.random() * 5);
            });
            gameState.actionsToday++;
            advanceDay();
            showModal('Action Effectu√©e', `Vous avez effectu√© l'action avec succ√®s! +${act.xp} XP`);
        }

        function checkPromotion() {
            const nextRankXP = (gameState.player.rank + 1) * 1000 * (1 + gameState.player.rank * 0.5);
            if (gameState.player.experience >= nextRankXP && gameState.player.rank < RANKS.length - 1) {
                gameState.player.rank += 1;
                gameState.player.totalPromotions += 1;
                gameState.player.promotionHistory.push({ date: gameState.currentDate.toLocaleDateString('fr-FR'), rank: RANKS[gameState.player.rank] });
                addJournalEntry(`Promotion √† ${RANKS[gameState.player.rank]}!`);
                showModal('Promotion!', `Vous √™tes promu √† ${RANKS[gameState.player.rank]}!`);
            }
        }

        function updateSkills() {
            document.getElementById('skillShooting').style.width = gameState.player.skills.shooting + '%';
            document.getElementById('skillShootingLevel').textContent = `${getLevel(gameState.player.skills.shooting)} (${Math.floor(gameState.player.skills.shooting)}/100)`;
            document.getElementById('skillMelee').style.width = gameState.player.skills.melee + '%';
            document.getElementById('skillMeleeLevel').textContent = `${getLevel(gameState.player.skills.melee)} (${Math.floor(gameState.player.skills.melee)}/100)`;
            document.getElementById('skillTactics').style.width = gameState.player.skills.tactics + '%';
            document.getElementById('skillTacticsLevel').textContent = `${getLevel(gameState.player.skills.tactics)} (${Math.floor(gameState.player.skills.tactics)}/100)`;
            document.getElementById('skillLeadership').style.width = gameState.player.skills.leadership + '%';
            document.getElementById('skillLeadershipLevel').textContent = `${getLevel(gameState.player.skills.leadership)} (${Math.floor(gameState.player.skills.leadership)}/100)`;
            document.getElementById('skillSurvival').style.width = gameState.player.skills.survival + '%';
            document.getElementById('skillSurvivalLevel').textContent = `${getLevel(gameState.player.skills.survival)} (${Math.floor(gameState.player.skills.survival)}/100)`;
            document.getElementById('skillMechanics').style.width = gameState.player.skills.mechanics + '%';
            document.getElementById('skillMechanicsLevel').textContent = `${getLevel(gameState.player.skills.mechanics)} (${Math.floor(gameState.player.skills.mechanics)}/100)`;
        }

        function updateHealth() {
            document.getElementById('globalHealth').style.width = gameState.player.health + '%';
            document.getElementById('globalHealthStatus').textContent = `${getHealthStatus(gameState.player.health)} (${Math.floor(gameState.player.health)}/100)`;
            document.getElementById('healthHead').style.width = gameState.player.health_parts.head + '%';
            document.getElementById('healthHeadStatus').textContent = gameState.player.health_parts.head > 75 ? 'Sain' : gameState.player.health_parts.head > 25 ? 'Bless√©' : 'Critique';
            document.getElementById('healthChest').style.width = gameState.player.health_parts.chest + '%';
            document.getElementById('healthChestStatus').textContent = gameState.player.health_parts.chest > 75 ? 'Sain' : gameState.player.health_parts.chest > 25 ? 'Bless√©' : 'Critique';
            document.getElementById('healthArmRight').style.width = gameState.player.health_parts.armRight + '%';
            document.getElementById('healthArmRightStatus').textContent = gameState.player.health_parts.armRight > 75 ? 'Sain' : gameState.player.health_parts.armRight > 25 ? 'Bless√©' : 'Critique';
            document.getElementById('healthLegRight').style.width = gameState.player.health_parts.legRight + '%';
            document.getElementById('healthLegRightStatus').textContent = gameState.player.health_parts.legRight > 75 ? 'Sain' : gameState.player.health_parts.legRight > 25 ? 'Bless√©' : 'Critique';
        }

        function updateMental() {
            document.getElementById('mentalMoral').style.width = gameState.player.mental.moral + '%';
            document.getElementById('mentalMoralStatus').textContent = `${getMentalStatus(gameState.player.mental.moral)} (${Math.floor(gameState.player.mental.moral)}/100)`;
            document.getElementById('mentalStress').style.width = gameState.player.mental.stress + '%';
            document.getElementById('mentalStressStatus').textContent = `${getMentalStatus(gameState.player.mental.stress)} (${Math.floor(gameState.player.mental.stress)}/100)`;
            document.getElementById('mentalResilience').style.width = gameState.player.mental.resilience + '%';
            document.getElementById('mentalResilienceStatus').textContent = `${getMentalStatus(gameState.player.mental.resilience)} (${Math.floor(gameState.player.mental.resilience)}/100)`;
        }

        function updateRelations() {
            const list = document.getElementById('relationsList');
            list.innerHTML = '';
            NPCS.forEach(npc => {
                const card = document.createElement('div');
                card.className = 'npc-card';
                card.innerHTML = `
                    <div class="name">${npc.name}</div>
                    <div class="relation">Relation: ${Math.floor(gameState.player.relations[npc.name])}%</div>
                    <div class="actions">
                        <button class="btn" onclick="interactWith('${npc.name}')">Interagir</button>
                    </div>
                `;
                list.appendChild(card);
            });
        }

        function updateMessages() {
            const list = document.getElementById('messagesList');
            list.innerHTML = '';
            gameState.player.messages.forEach(msg => {
                const box = document.createElement('div');
                box.className = 'message-box';
                box.innerHTML = `
                    <div class="sender">De: ${msg.sender}</div>
                    <div class="content">${msg.content}</div>
                `;
                list.appendChild(box);
            });
        }

        function updateInventory() {
            const list = document.getElementById('inventoryList');
            list.innerHTML = '';
            gameState.player.inventory.forEach(item => {
                const entry = document.createElement('div');
                entry.className = 'inventory-item';
                entry.innerHTML = `
                    <div class="name">${item.name}</div>
                    <div class="quantity">x${item.quantity}</div>
                `;
                list.appendChild(entry);
            });
        }

        function updateDecorations() {
            const list = document.getElementById('decorationsList');
            list.innerHTML = '';
            gameState.player.decorations.forEach(dec => {
                const card = document.createElement('div');
                card.className = 'decoration-card';
                card.innerHTML = `<h3>${dec.name}</h3><p>Obtenue le ${dec.date}</p>`;
                list.appendChild(card);
            });
        }

        function updateMap() {
            const container = document.getElementById('mapContainer');
            container.innerHTML = '<canvas id="mapCanvas" width="800" height="600"></canvas>';
            const canvas = document.getElementById('mapCanvas');
            const ctx = canvas.getContext('2d');

            // Draw map background (simple for now)
            ctx.fillStyle = '#333';
            ctx.fillRect(0, 0, 800, 600);

            // Draw locations
            LOCATIONS.forEach(loc => {
                const x = (loc.y + 180) * (800 / 360);
                const y = (90 - loc.x) * (600 / 180);
                ctx.fillStyle = loc.name === gameState.player.location ? '#ff9800' : '#d4af37';
                ctx.beginPath();
                ctx.arc(x, y, 5, 0, 2 * Math.PI);
                ctx.fill();
                ctx.fillStyle = '#fff';
                ctx.fillText(loc.name, x + 10, y + 5);
            });
        }

        function old_updateMap() {
            const container = document.getElementById('mapContainer');
            container.innerHTML = '';
            LOCATIONS.forEach(loc => {
                const card = document.createElement('div');
                card.className = 'location-card';
                card.innerHTML = `<h3>${loc.name}</h3><p>${loc.country}</p>`;
                if (loc.name === gameState.player.location) {
                    card.style.borderColor = '#ff9800';
                }
                card.onclick = () => travelTo(loc.name);
                container.appendChild(card);
            });
        }

        function updateMissions() {
            const list = document.getElementById('missionsList');
            list.innerHTML = '';
            const missions = gameState.isWarTime ? WAR_MISSIONS : PEACE_MISSIONS;
            missions.forEach(mission => {
                const card = document.createElement('div');
                card.className = 'mission-card';
                card.innerHTML = `
                    <h3>${mission.name}</h3>
                    <p>${mission.description}</p>
                    <div class="reward">R√©compense: ${mission.reward.xp} XP</div>
                    <div class="actions">
                        <button class="btn" onclick="acceptMission('${mission.id}')">Accepter</button>
                    </div>
                `;
                list.appendChild(card);
            });
        }

        function updateCareer() {
            const history = document.getElementById('promotionHistory');
            history.innerHTML = '';
            gameState.player.promotionHistory.forEach(p => {
                const entry = document.createElement('div');
                entry.className = 'career-entry';
                entry.innerHTML = `<div class="date">${p.date}</div><div class="rank">${p.rank}</div>`;
                history.appendChild(entry);
            });
        }

        function addJournalEntry(content) {
            gameState.player.journal.unshift({ date: gameState.currentDate.toLocaleDateString('fr-FR'), content: content });
            const list = document.getElementById('journalEntries');
            if (list) {
                list.innerHTML = '';
                gameState.player.journal.forEach(entry => {
                    const div = document.createElement('div');
                    div.className = 'journal-entry';
                    div.innerHTML = `<div class="date">${entry.date}</div><div class="content">${entry.content}</div>`;
                    list.appendChild(div);
                });
            }
        }

        function showModal(title, body, footerButtons = []) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalBody').innerHTML = body;
            const footer = document.getElementById('modalFooter');
            footer.innerHTML = '';
            footerButtons.forEach(btn => {
                const button = document.createElement('button');
                button.className = `btn ${btn.class || ''}`;
                button.textContent = btn.text;
                button.onclick = btn.onclick;
                footer.appendChild(button);
            });
            if (footerButtons.length === 0) {
                const okButton = document.createElement('button');
                okButton.className = 'btn btn-primary';
                okButton.textContent = 'OK';
                okButton.onclick = closeModal;
                footer.appendChild(okButton);
            }
            document.getElementById('modal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
        }

        function saveGame() {
            localStorage.setItem('eisernesKreuzSave', JSON.stringify(gameState));
        }

        function loadGame() {
            const savedGame = localStorage.getItem('eisernesKreuzSave');
            if (savedGame) {
                gameState = JSON.parse(savedGame);
                gameState.currentDate = new Date(gameState.currentDate);
                gameState.gameStarted = true;
                updateDashboard();
                showPage('dashboard');
            } else {
                alert('Aucune partie sauvegard√©e trouv√©e.');
            }
        }

        function resetGame() {
            if (confirm('√ätes-vous s√ªr de vouloir recommencer une nouvelle partie? Toute progression sera perdue.')) {
                localStorage.removeItem('eisernesKreuzSave');
                location.reload();
            }
        }

        function getLevel(skill) {
            if (skill >= 90) return 'Ma√Ætre';
            if (skill >= 75) return 'Expert';
            if (skill >= 50) return 'Comp√©tent';
            if (skill >= 25) return 'Initi√©';
            return 'Novice';
        }

        function getHealthStatus(health) {
            if (health >= 90) return 'Excellente';
            if (health >= 70) return 'Bonne';
            if (health >= 40) return 'Moyenne';
            if (health >= 10) return 'Faible';
            return 'Critique';
        }

        function getMentalStatus(value) {
            if (value >= 80) return '√âlev√©';
            if (value >= 60) return 'Bon';
            if (value >= 40) return 'Moyen';
            if (value >= 20) return 'Faible';
            return 'Critique';
        }

        function travelTo(location) {
            if (location === gameState.player.location) return;
            const travelTime = Math.floor(Math.random() * 5) + 1;
            for (let i = 0; i < travelTime; i++) advanceDay();
            gameState.player.location = location;
            addJournalEntry(`Voyage √† ${location}.`);
            updateDashboard();
            updateMap();
        }

        function interactWith(npcName) {
            const npc = NPCS.find(n => n.name === npcName);
            if (!npc) return;

            let interactionOptions = [];
            if (npc.relation === 'Sup√©rieur') {
                interactionOptions = [
                    { text: 'Saluer respectueusement', action: () => { changeRelation(npcName, 5); showModal('Interaction', 'Vous saluez votre sup√©rieur, qui hoche la t√™te en retour.'); } },
                    { text: 'Demander un conseil', action: () => { changeRelation(npcName, 10); showModal('Interaction', 'Votre sup√©rieur vous donne un conseil avis√©.'); } },
                    { text: 'Se plaindre', action: () => { changeRelation(npcName, -15); showModal('Interaction', 'Votre sup√©rieur n\`appr√©cie pas votre plainte.'); } },
                ];
            } else if (npc.relation === 'Unit√©') {
                interactionOptions = [
                    { text: 'Partager une ration', action: () => { changeRelation(npcName, 10); showModal('Interaction', 'Vous partagez votre ration avec votre camarade.'); } },
                    { text: 'Parler de la famille', action: () => { changeRelation(npcName, 15); showModal('Interaction', 'Vous parlez de votre famille avec votre camarade.'); } },
                    { text: 'Se vanter', action: () => { changeRelation(npcName, -5); showModal('Interaction', 'Votre camarade n\`est pas impressionn√© par votre vantardise.'); } },
                ];
            } else if (npc.relation === 'Famille') {
                interactionOptions = [
                    { text: '√âcrire une lettre', action: () => { changeRelation(npcName, 20); showModal('Interaction', 'Vous √©crivez une lettre √† votre famille.'); } },
                ];
            }

            const modalButtons = interactionOptions.map(opt => ({ text: opt.text, onclick: opt.action, class: 'btn-primary' }));
            showModal(`Interagir avec ${npcName}`, 'Que voulez-vous faire?', modalButtons);
        }

        function changeRelation(npcName, amount) {
            gameState.player.relations[npcName] = Math.max(0, Math.min(100, gameState.player.relations[npcName] + amount));
            updateRelations();
        }

        function old_interactWith(npcName) {
            const relation = gameState.player.relations[npcName];
            const outcome = Math.random();
            if (outcome > 0.5) {
                gameState.player.relations[npcName] = Math.min(100, relation + 5);
                showModal('Interaction Positive', `Votre conversation avec ${npcName} s'est bien pass√©e.`);
            } else {
                gameState.player.relations[npcName] = Math.max(0, relation - 5);
                showModal('Interaction N√©gative', `Votre conversation avec ${npcName} a √©t√© tendue.`);
            }
            updateRelations();
        }

        // Initialisation
        window.onload = () => {
            if (localStorage.getItem('eisernesKreuzSave')) {
                loadGame();
            } else {
                showPage('creation');
            }
        };
    </script>
</body>
</html>
